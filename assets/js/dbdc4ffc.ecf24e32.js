"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[1602],{7588:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>c,frontMatter:()=>a,metadata:()=>d,toc:()=>u});var t=o(5893),r=o(1151);const a={sidebar_position:1},s="SUC Upgrade Troubleshooting",d={id:"upgrades/suc_upgrade",title:"SUC Upgrade Troubleshooting",description:"This is not official documentation for AutomationSuite",source:"@site/docs/upgrades/suc_upgrade.md",sourceDirName:"upgrades",slug:"/upgrades/suc_upgrade",permalink:"/automation-suite-support-tools/docs/upgrades/suc_upgrade",draft:!1,unlisted:!1,editUrl:"https://uipath.github.com/UiPath/automation-suite-support-tools/edit/master/docs/docs/upgrades/suc_upgrade.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Upgrade Troubleshooting",permalink:"/automation-suite-support-tools/docs/category/upgrade-troubleshooting"}},i={},u=[{value:"Issue1",id:"issue1",level:2},{value:"Workaround",id:"workaround",level:3},{value:"Symptoms",id:"symptoms",level:3}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"suc-upgrade-troubleshooting",children:"SUC Upgrade Troubleshooting"}),"\n",(0,t.jsx)(n.admonition,{title:"Note",type:"danger",children:(0,t.jsx)(n.p,{children:"This is not official documentation for AutomationSuite"})}),"\n",(0,t.jsx)(n.h2,{id:"issue1",children:"Issue1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"The upgrade timeout with Error: cannot execute upgrade plan on agent nodes: context canceled, however, all the nodes were upgraded. \n"})}),"\n",(0,t.jsx)(n.h3,{id:"workaround",children:"Workaround"}),"\n",(0,t.jsx)(n.p,{children:"The Rerun upgrade passed without any issues."}),"\n",(0,t.jsx)(n.h3,{id:"symptoms",children:"Symptoms"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Upgrade log:"}),"\nFrom the first node upgrade log, all the nodes upgraded but failed with context canceled for the agent plan."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"[INFO] [2023-10-11T12:51:12+0000]: Running upgrade on all nodes...\nError: cannot execute upgrade plan on agent nodes: context canceled\n[INFO] [2023-10-11T13:51:12+0000]: Node details:\n[INFO] [2023-10-11T13:51:12+0000]: NAME      STATUS   ROLES                       AGE     VERSION\nagent0    Ready    <none>                      6h44m   v1.26.5+rke2r1\nserver0   Ready    control-plane,etcd,master   7h18m   v1.26.5+rke2r1\nserver1   Ready    control-plane,etcd,master   7h2m    v1.26.5+rke2r1\nserver2   Ready    control-plane,etcd,master   6h53m   v1.26.5+rke2r1\n[INFO] [2023-10-11T13:51:12+0000]: Refer the log files in /opt/UiPathAutomationSuite/_upgrade/UiPath_Installer/Modules/../upgrade-logs/upgrade-2023.10.0-rc.12\n[INFO] [2023-10-11T13:51:16+0000]: Rke upgrade information is available at system-upgrade namespace. Use kubectl command to get the logs and events.\n[INFO] [2023-10-11T13:51:16+0000]: Logs also present in the corresponding node at /opt/UiPathAutomationSuite/_autoupgrade\n^[[0;31m[ERROR][2023-10-11T13:51:16+0000]:^[[0m Upgrade failed. Please fix the errors and try again.\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"From the agent node log (upgraded succeeded)"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"/opt/UiPathAutomationSuite/<version>/installer/logfile-apply-a-upgrade-<version>-on-agent0-with-<some-random-hash>.log\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'[INFO] [2023-10-12T12:42:53+0000]: Infra installed successfully\n[INFO] [2023-10-12T12:42:53+0000]: Validate rke2 images update in the upgrade hook\n[INFO] [2023-10-12T12:42:53+0000]: checking all rke2 pods are up and running in the current node\npod/kube-proxy-agent0 condition met\n[INFO] [2023-10-12T12:42:54+0000]: Uncordoning node in the upgrade hook\nChecking if node  is ready to run kubectl command.\nNode is ready to accept kubectl command\nEnable IP Forwarding...\nEither file /etc/sysctl.conf not present or file is not writable. Enabling ip forward using /proc/sys/net/ipv4/ip_forward...\nUncordon agent0 ...\nlabel "nodejanitor/skip" not found.\nnode/agent0 not labeled\nnode/agent0 already uncordoned\nnode/agent0 annotated\n[INFO] [2023-10-12T12:42:54+0000]: Upgrade successfully completed.\n'})})]})}function c(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},1151:(e,n,o)=>{o.d(n,{Z:()=>d,a:()=>s});var t=o(7294);const r={},a=t.createContext(r);function s(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);